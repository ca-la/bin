#!/bin/bash

set -o errexit
set -o nounset
set -o pipefail
set -o noglob

# Release new version
# Usage: bin/release <patch|minor|major>

take_action() {
  source bin/lib/colors

  bin/test

  echo "Releasing $1..."
  npx cala-release $1
  echo -e "${green}Done${reset}"
}

usage_fail() {
  echo "Usage: bin/release <patch|minor|major>"
  exit 1
}

main() {
  semver=${1:-""}

  case "$semver" in
    patch|minor|major)
      take_action "$semver"
      ;;
    *)
      usage_fail
      ;;
  esac
}

main "$@"
