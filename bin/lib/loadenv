#!/bin/bash

set -o errexit
set -o nounset
set -o pipefail
set -o noglob

# Load environment variables from .env or Heroku config

function loadenv_file() {
  filename=${1:-""}
  if [[ "$filename" == "" ]]; then
    echo "No filename provided to loadenv_file"
    exit 1
  fi

  set -o allexport
  source $filename
  set +o allexport
}

function loadenv_local() {
  loadenv_file .env
}

function loadenv_test() {
  loadenv_local
  loadenv_file .test.env
}

function loadenv_heroku() {
  set -o allexport
  envvars=$(heroku config -s -a $1 | xargs -d "\n")
  eval $envvars
  set +o allexport
}

function loadenv_stg() {
  loadenv_heroku cala-api-stg
}

function loadenv_prod() {
  loadenv_heroku cala-api-prod
}

function loadenv_demo() {
  loadenv_heroku cala-api-demo
}
