#!/bin/bash

set -o errexit
set -o nounset
set -o pipefail
set -o noglob

# Load environment variables from .env or Heroku config

function loadenv() {
  set -o allexport
  envvars=$($@ | xargs -d "\n")
  eval $envvars
  set +o allexport
}

function loadenv_local() {
  loadenv "cat .env"
}

function loadenv_test() {
  loadenv_local
  loadenv "cat .test.env"
}

function loadenv_heroku() {
  set -o allexport
  envvars=$(heroku config -s -a $1 | xargs -d "\n")
  eval $envvars
  DATABASE_URL=$(heroku config:get DATABASE_URL -a $1)?ssl=true
  set +o allexport
}

function loadenv_stg() {
  loadenv_heroku cala-api-stg
}

function loadenv_prod() {
  loadenv_heroku cala-api-prod
}

function loadenv_demo() {
  loadenv_heroku cala-api-demo
}
