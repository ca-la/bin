#!/bin/bash

set -o errexit
set -o nounset
set -o pipefail
set -o noglob

# Run TypeScript compiler and API server in watch mode
# Usage: bin/dev

main() {
  trap "kill 0" EXIT # Kill children when this process is killed

  source bin/lib/loadenv
  loadenv_local

  npx tsc --preserveWatchOutput -w -p . &
  npx nodemon --delay 2 -w ./dist dist &

  wait
}

main "$@"
