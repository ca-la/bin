#!/bin/bash

set -o errexit
set -o nounset
set -o pipefail
set -o noglob

# Purges all unsent/unread notifications
# Usage: bin/purge_notifications <local|built>

run() {
  source bin/lib/loadenv

  host=${1:-""}

  case "$host" in
    local)
      loadenv_local
      npx ts-node src/workers/purge-notifications/index.ts
      ;;
    built)
      node dist/workers/purge-notifications/index.js
      ;;
    *)
      echo 'Usage: bin/purge_notifications <local|built>'
      exit 1
      ;;
  esac
}

run "$@"
