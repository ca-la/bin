#!/bin/bash

set -euo pipefail

main() {
  NAME=${1:-""}

  if [ "$NAME" == "" ]; then
    echo "Usage: create-migration [migration-name]"
    exit 1
  fi

  DATE=$(date "+%Y%m%d%H%M%S")

  FILENAME=migrations/$DATE'_'$NAME.js
  cp migrations/_template $FILENAME
  echo 'Created '$FILENAME

  echo -n 'Open in $EDITOR? '
  read -n 1 EDIT

  if [ "$EDIT" == "y" ]; then
    $EDITOR $FILENAME
  fi
}

main "$@"
